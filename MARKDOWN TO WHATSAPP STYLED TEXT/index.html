<!DOCTYPE html>
<html lang="it" data-theme="light">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />
  <title>MD to WA | V5 Stable</title>

  <!-- Tailwind CSS (required) -->
  <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>

  <script src="https://unpkg.com/@phosphor-icons/web"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=JetBrains+Mono:wght@500&display=swap" rel="stylesheet">

  <style>
    * { box-sizing: border-box; }

    /* DESIGN SYSTEM */
    :root {
      --bg-base: #dfe3e5;
      --bg-panel: #ffffff;
      --bg-input: #f0f2f5;
      --primary: #008069;
      --accent: #25d366;
      --text-main: #111b21;
      --text-mute: #54656f;
      --border: #e9edef;
      --radius: 12px;
      --shadow: 0 4px 6px -1px rgba(0,0,0,0.1);
    }

    [data-theme="dark"] {
      --bg-base: #0b141a;
      --bg-panel: #202c33;
      --bg-input: #111b21;
      --primary: #00a884;
      --text-main: #e9edef;
      --text-mute: #aebac1;
      --border: #2a3942;
    }

    html, body { height: 100%; }
    body {
      margin: 0;
      min-height: 100vh;
      min-height: 100dvh;
      height: 100dvh;
      display: flex;
      flex-direction: column;
      font-family: 'Inter', sans-serif;
      background: var(--bg-base);
      color: var(--text-main);
      -webkit-text-size-adjust: 100%;
      overscroll-behavior: none;
    }

    /* HEADER */
    .app-header {
      height: calc(60px + env(safe-area-inset-top));
      padding-top: env(safe-area-inset-top);
      background: var(--bg-panel);
      border-bottom: 1px solid var(--border);
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding-left: 20px;
      padding-right: 20px;
      z-index: 10;
      flex: 0 0 auto;
    }

    .brand {
      font-weight: 700;
      color: var(--text-main);
      display: flex;
      gap: 8px;
      align-items: center;
      letter-spacing: -0.01em;
    }

    .brand i { color: var(--primary); font-size: 24px; }

    .header-actions { display: flex; align-items: center; gap: 2px; }

    .header-actions button {
      background: none;
      border: none;
      font-size: 18px;
      color: var(--text-mute);
      cursor: pointer;
      padding: 8px;
      border-radius: 999px;
      transition: background 0.15s ease, color 0.15s ease, transform 0.05s ease;
      display: inline-flex;
      align-items: center;
      justify-content: center;
    }

    .header-actions button:hover { background: var(--bg-input); color: var(--text-main); }
    .header-actions button:active { transform: scale(0.98); }
    .header-actions button:disabled { opacity: 0.45; cursor: not-allowed; }
    .header-actions button:disabled:hover { background: none; color: var(--text-mute); }

    /* Mobile switch (visible only on small screens) */
    .mobile-switch {
      display: none;
      background: var(--bg-panel);
      border-bottom: 1px solid var(--border);
      padding: 10px 12px;
      gap: 8px;
      align-items: center;
      justify-content: center;
      flex: 0 0 auto;
    }

    .seg {
      display: flex;
      width: min(520px, 100%);
      background: var(--bg-input);
      border: 1px solid var(--border);
      border-radius: 999px;
      padding: 4px;
      gap: 4px;
    }

    .seg button {
      flex: 1;
      border: none;
      background: transparent;
      padding: 9px 10px;
      border-radius: 999px;
      font-weight: 700;
      font-size: 12px;
      letter-spacing: 0.02em;
      color: var(--text-mute);
      cursor: pointer;
      display: inline-flex;
      gap: 8px;
      align-items: center;
      justify-content: center;
      transition: 0.15s ease;
    }

    .seg button.active {
      background: var(--bg-panel);
      color: var(--text-main);
      box-shadow: var(--shadow);
    }

    /* WORKSPACE */
    .stage {
      flex: 1;
      display: flex;
      overflow: hidden;
      min-height: 0;
    }

    /* EDITOR PANE */
    .pane-input {
      flex: 1;
      background: var(--bg-panel);
      border-right: 1px solid var(--border);
      display: flex;
      flex-direction: column;
      min-width: 0;
      min-height: 0;
    }

    .editor-bar {
      padding: 10px 12px;
      border-bottom: 1px solid var(--border);
      display: flex;
      gap: 8px;
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
      align-items: center;
    }

    .editor-bar::-webkit-scrollbar { height: 8px; }

    .chip {
      padding: 7px 12px;
      font-size: 11px;
      font-weight: 800;
      border-radius: 999px;
      background: var(--bg-input);
      color: var(--text-mute);
      cursor: pointer;
      white-space: nowrap;
      transition: 0.15s ease;
      border: 1px solid transparent;
    }

    .chip:hover { border-color: var(--border); color: var(--text-main); }

    .hint {
      margin-left: auto;
      font-size: 11px;
      color: var(--text-mute);
      white-space: nowrap;
      padding-right: 4px;
    }

    #raw-input {
      flex: 1;
      resize: none;
      border: none;
      padding: 18px;
      outline: none;
      font-family: 'JetBrains Mono', monospace;
      font-size: 14px;
      line-height: 1.55;
      background: var(--bg-panel);
      color: var(--text-main);
      min-height: 0;
      padding-bottom: max(18px, env(safe-area-inset-bottom));
    }

    #raw-input::placeholder { color: color-mix(in srgb, var(--text-mute) 85%, transparent); }

    /* PREVIEW PANE */
    .pane-view {
      flex: 1;
      display: flex;
      flex-direction: column;
      position: relative;
      min-width: 0;
      min-height: 0;
      background-image: url('https://user-images.githubusercontent.com/15075759/28719144-86dc0f70-73b1-11e7-911d-60d70fcded21.png');
      background-color: #efeae2;
      background-size: 410px;
    }

    [data-theme="dark"] .pane-view {
      background: var(--bg-base);
      background-image: none;
    }

    .chat-scroll {
      flex: 1;
      overflow-y: auto;
      padding: 18px 5%;
      display: flex;
      flex-direction: column;
      min-height: 0;
    }

    .bubble-card {
      background: #d9fdd3;
      border-radius: 14px;
      border-top-right-radius: 6px;
      padding: 10px 14px 28px 14px;
      position: relative;
      align-self: center;
      width: 100%;
      max-width: 650px;
      box-shadow: var(--shadow);
      border: 1px solid rgba(0,0,0,0.05);
    }

    [data-theme="dark"] .bubble-card {
      background: #005c4b;
      border: 1px solid rgba(255,255,255,0.06);
    }

    .msg-text {
      font-size: 15px;
      line-height: 1.55;
      white-space: pre-wrap;
      word-wrap: break-word;
    }

    /* Whatsapp Visual Rendering Classes */
    .wa-bi { font-weight: 800; font-style: italic; }
    .wa-b { font-weight: 800; }
    .wa-i { font-style: italic; }
    .wa-mono {
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      background: rgba(0,0,0,0.12);
      padding: 1px 4px;
      border-radius: 4px;
      font-size: 0.92em;
    }

    [data-theme="dark"] .wa-mono { background: rgba(255,255,255,0.12); }

    .wa-line {
      border-top: 1px dashed var(--text-mute);
      display: block;
      margin: 12px 0;
      opacity: 0.45;
    }

    .meta {
      position: absolute;
      bottom: 6px;
      right: 10px;
      font-size: 10px;
      color: rgba(0,0,0,0.45);
      display: flex;
      align-items: center;
      gap: 4px;
      user-select: none;
    }

    [data-theme="dark"] .meta { color: rgba(255,255,255,0.5); }

    /* FLOAT BUTTON */
    .float-btn {
      position: absolute;
      bottom: 22px;
      right: 22px;
      z-index: 100;
      background: var(--primary);
      color: white;
      border: none;
      height: 52px;
      padding: 0 18px;
      border-radius: 999px;
      font-weight: 800;
      display: inline-flex;
      align-items: center;
      gap: 10px;
      box-shadow: 0 10px 24px rgba(0,0,0,0.22);
      cursor: pointer;
      transition: transform 0.15s ease, background 0.15s ease;
    }

    .float-btn:hover { transform: translateY(-2px); background: color-mix(in srgb, var(--primary) 65%, #00a884); }
    .float-btn:active { transform: scale(0.98); }

    /* TOAST */
    .toast {
      position: fixed;
      bottom: max(20px, env(safe-area-inset-bottom));
      left: 50%;
      transform: translateX(-50%) translateY(20px);
      background: #111;
      color: #fff;
      padding: 12px 16px;
      border-radius: 999px;
      opacity: 0;
      pointer-events: none;
      transition: 0.25s ease;
      display: inline-flex;
      align-items: center;
      gap: 10px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.35);
      z-index: 200;
      max-width: calc(100vw - 24px);
    }

    .toast.in { opacity: 1; transform: translateX(-50%) translateY(0); }

    /* MOBILE */
    @media (max-width: 900px) {
      .mobile-switch { display: flex; }
      .stage { flex-direction: column; }
      .pane-input { border-right: none; border-bottom: 1px solid var(--border); }

      /* Single-view mode on mobile */
      body[data-mobile-view="editor"] .pane-view { display: none; }
      body[data-mobile-view="preview"] .pane-input { display: none; }

      .float-btn { bottom: 16px; right: 16px; }
      .chat-scroll { padding: 14px 12px; }
      #raw-input { padding: 14px; }
      .hint { display: none; }
    }

    @media (prefers-reduced-motion: reduce) {
      .toast, .float-btn, .header-actions button, .chip { transition: none !important; }
    }
  </style>
</head>
<body data-mobile-view="editor">
  <header class="app-header">
    <div class="brand"><i class="ph-fill ph-whatsapp-logo"></i> <span>Studio V5</span></div>

    <div class="header-actions">
      <button id="btn-undo" title="Annulla (Ctrl/Cmd+Z)" aria-label="Annulla">
        <i class="ph ph-arrow-u-up-left"></i>
      </button>
      <button id="btn-redo" title="Ripeti (Ctrl/Cmd+Shift+Z o Ctrl/Cmd+Y)" aria-label="Ripeti">
        <i class="ph ph-arrow-u-up-right"></i>
      </button>
      <button id="btn-theme" title="Tema" aria-label="Cambia tema">
        <i class="ph ph-moon"></i>
      </button>
      <button id="btn-clean" title="Pulisci" aria-label="Pulisci testo">
        <i class="ph ph-trash"></i>
      </button>
    </div>
  </header>

  <div class="mobile-switch" aria-label="Modalità mobile">
    <div class="seg" role="tablist" aria-label="Scrivi o Anteprima">
      <button id="tab-editor" class="active" role="tab" aria-selected="true"><i class="ph ph-pencil-simple"></i> Scrivi</button>
      <button id="tab-preview" role="tab" aria-selected="false"><i class="ph ph-chat-teardrop-text"></i> Anteprima</button>
    </div>
  </div>

  <div class="stage">
    <!-- EDIT ZONE -->
    <section class="pane pane-input">
      <div class="editor-bar">
        <button class="chip" data-action="h3">TITOLO</button>
        <button class="chip" data-action="bold">GRASSETTO</button>
        <button class="chip" data-action="italic">CORSIVO</button>
        <button class="chip" data-action="list">LISTA</button>
        <div class="hint">Ctrl/Cmd+Z / Ctrl/Cmd+Shift+Z</div>
      </div>
      <textarea id="raw-input" placeholder="Incolla il testo..."></textarea>
    </section>

    <!-- PREVIEW ZONE -->
    <section class="pane pane-view">
      <div class="chat-scroll">
        <div class="bubble-card">
          <div id="output-render" class="msg-text">
            <i style="color:grey; font-size:14px">Il testo formattato apparirà qui...</i>
          </div>
          <div class="meta">
            <span id="time-display">18:00</span>
            <i class="ph-bold ph-checks" style="color:#53bdeb"></i>
          </div>
        </div>
      </div>

      <button class="float-btn" id="btn-convert">
        <i class="ph-bold ph-copy"></i>
        <span>Copia per WhatsApp</span>
      </button>
    </section>
  </div>

  <div id="toast-el" class="toast" role="status" aria-live="polite">
    <i id="toast-icon" class="ph-fill ph-check-circle" style="color:#4ade80"></i>
    <span id="toast-text">Convertito e Copiato!</span>
  </div>

  <script>
    const DOM = {
      input: document.getElementById('raw-input'),
      output: document.getElementById('output-render'),
      btnConvert: document.getElementById('btn-convert'),
      btnTheme: document.getElementById('btn-theme'),
      btnClean: document.getElementById('btn-clean'),
      btnUndo: document.getElementById('btn-undo'),
      btnRedo: document.getElementById('btn-redo'),
      toast: document.getElementById('toast-el'),
      toastText: document.getElementById('toast-text'),
      toastIcon: document.getElementById('toast-icon'),
      time: document.getElementById('time-display'),
      tabEditor: document.getElementById('tab-editor'),
      tabPreview: document.getElementById('tab-preview'),
      editorBar: document.querySelector('.editor-bar')
    };

    const Engine = {
      /**
       * Markdown-ish -> WhatsApp text
       */
      processMDtoWA(text) {
        if (!text) return "";
        let s = text;

        // 1) HR
        s = s.replace(/^(?:\*\*\*|---|___)\s*$/gm, "⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯");

        // 2) Lists: normalize bullets to '-'
        s = s.replace(/^(\s*)[\*\+\-](?=\s)/gm, "$1-");

        // 3) Tokenize special segments
        // A) Headers (# .. ######)
        s = s.replace(/^(#{1,6})\s+(.*)$/gm, (m, h, content) => {
          return `@@HEAD_START@@${content.trim().toUpperCase()}@@HEAD_END@@`;
        });

        // B) Inline code
        s = s.replace(/`([^`\n]+)`/g, "@@CODE_START@@$1@@CODE_END@@");

        // C) Bold (**text** or __text__)
        s = s.replace(/(\*\*|__)(?=\S)(.+?)(?<=\S)\1/g, "@@BOLD_START@@$2@@BOLD_END@@");

        // 4) Italic remaining (*text* or _text_) -> WA italic uses _
        s = s.replace(/(\*|_)(?=\S)(.+?)(?<=\S)\1/g, "_$2_");

        // 5) Restore tokens
        s = s.replace(/@@BOLD_START@@/g, "*").replace(/@@BOLD_END@@/g, "*");
        s = s.replace(/@@CODE_START@@/g, "`").replace(/@@CODE_END@@/g, "`");
        s = s.replace(/@@HEAD_START@@/g, "_*").replace(/@@HEAD_END@@/g, "*_");

        // Cleanup any broken tokens
        s = s.replace(/@@[A-Z_]+@@/g, "");
        return s;
      },

      /**
       * WhatsApp text -> HTML preview
       */
      processWAtoHTML(waText) {
        if (!waText) return "";
        let h = waText;

        // Escape HTML
        h = h.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;");

        // Titles (_*...*_)
        h = h.replace(/_\*([^*]+)\*_/g, '<span class="wa-bi">$1</span>');

        // Bold (*...*)
        h = h.replace(/\*([^*]+)\*/g, '<span class="wa-b">$1</span>');

        // Italic (_..._)
        h = h.replace(/_([^_]+)_/g, '<span class="wa-i">$1</span>');

        // HR
        h = h.replace(/⎯{5,}/g, '<span class="wa-line"></span>');

        // Inline code
        h = h.replace(/`([^`]+)`/g, '<span class="wa-mono">$1</span>');

        // New lines
        h = h.replace(/\n/g, "<br>");

        return h;
      }
    };

    // Custom history to guarantee undo/redo works even after programmatic edits
    const History = {
      stack: [],
      index: -1,
      max: 250,
      debounceId: null,
      suspend: false,

      initFromField(field) {
        this.stack = [{ value: field.value || "", start: field.selectionStart || 0, end: field.selectionEnd || 0 }];
        this.index = 0;
        this.updateUI();
      },

      snapshotFromField(field) {
        return { value: field.value, start: field.selectionStart, end: field.selectionEnd };
      },

      push(state, { force = false } = {}) {
        if (this.suspend) return;

        const current = this.stack[this.index];
        if (!force && current && current.value === state.value && current.start === state.start && current.end === state.end) return;

        if (this.index < this.stack.length - 1) this.stack = this.stack.slice(0, this.index + 1);
        this.stack.push(state);

        if (this.stack.length > this.max) {
          const overflow = this.stack.length - this.max;
          this.stack.splice(0, overflow);
          this.index = Math.max(0, this.index - overflow);
        }

        this.index = this.stack.length - 1;
        this.updateUI();
      },

      captureNow({ force = false } = {}) {
        this.push(this.snapshotFromField(DOM.input), { force });
      },

      scheduleCapture() {
        if (this.suspend) return;
        clearTimeout(this.debounceId);
        this.debounceId = setTimeout(() => this.captureNow(), 120);
      },

      canUndo() { return this.index > 0; },
      canRedo() { return this.index < this.stack.length - 1; },

      undo() {
        if (!this.canUndo()) return;
        this.index--;
        this.restore();
      },

      redo() {
        if (!this.canRedo()) return;
        this.index++;
        this.restore();
      },

      restore() {
        const s = this.stack[this.index];
        if (!s) return;
        this.suspend = true;
        DOM.input.value = s.value;
        try { DOM.input.setSelectionRange(s.start, s.end); } catch (_) {}
        this.suspend = false;
        this.updateUI();
        App.render();
      },

      updateUI() {
        DOM.btnUndo.disabled = !this.canUndo();
        DOM.btnRedo.disabled = !this.canRedo();
      }
    };

    const App = {
      init() {
        // Initial mobile view
        this.setMobileView('editor');

        // History
        History.initFromField(DOM.input);

        // Input: render + history
        DOM.input.addEventListener('input', () => {
          History.scheduleCapture();
          this.render();
        });

        // Strong keyboard undo/redo (Ctrl/Cmd+Z, Ctrl/Cmd+Shift+Z, Ctrl/Cmd+Y)
        DOM.input.addEventListener('keydown', (e) => {
          const isMod = e.ctrlKey || e.metaKey;
          if (!isMod || e.altKey) return;

          const k = (e.key || '').toLowerCase();
          if (k === 'z') {
            e.preventDefault();
            if (e.shiftKey) History.redo();
            else History.undo();
          } else if (k === 'y') {
            e.preventDefault();
            History.redo();
          }
        });

        // Buttons
        DOM.btnUndo.addEventListener('click', () => History.undo());
        DOM.btnRedo.addEventListener('click', () => History.redo());

        DOM.btnConvert.addEventListener('click', () => this.copy());

        DOM.btnClean.addEventListener('click', () => {
          if (confirm("Svuotare tutto?")) {
            // Programmatic change -> capture in our history
            DOM.input.value = "";
            try { DOM.input.setSelectionRange(0, 0); } catch (_) {}
            History.captureNow({ force: true });
            this.render();
          }
        });

        DOM.btnTheme.addEventListener('click', () => {
          const doc = document.documentElement;
          const next = doc.getAttribute('data-theme') === 'dark' ? 'light' : 'dark';
          doc.setAttribute('data-theme', next);
          this.syncThemeIcon(next);
        });

        // Chips (no inline onclick, so changes are trackable)
        DOM.editorBar.addEventListener('click', (e) => {
          const btn = e.target.closest('button[data-action]');
          if (!btn) return;
          const action = btn.getAttribute('data-action');
          if (action === 'h3') this.tagPrefix('### ');
          if (action === 'bold') this.tagWrap('**');
          if (action === 'italic') this.tagWrap('_');
          if (action === 'list') this.tagPrefix('- ');
        });

        // Mobile tabs
        DOM.tabEditor.addEventListener('click', () => this.setMobileView('editor'));
        DOM.tabPreview.addEventListener('click', () => this.setMobileView('preview'));

        // Clock
        this.clock();
        setInterval(() => this.clock(), 30000);

        // First render
        this.syncThemeIcon(document.documentElement.getAttribute('data-theme') || 'light');
        this.render();
      },

      setMobileView(view) {
        document.body.setAttribute('data-mobile-view', view);
        const isEditor = view === 'editor';
        DOM.tabEditor.classList.toggle('active', isEditor);
        DOM.tabEditor.setAttribute('aria-selected', String(isEditor));
        DOM.tabPreview.classList.toggle('active', !isEditor);
        DOM.tabPreview.setAttribute('aria-selected', String(!isEditor));

        // Keep focus helpful when switching
        if (isEditor) setTimeout(() => DOM.input.focus(), 0);
      },

      syncThemeIcon(theme) {
        const i = DOM.btnTheme.querySelector('i');
        if (!i) return;
        // Swap icons for clarity
        if (theme === 'dark') {
          i.className = 'ph ph-sun';
          DOM.btnTheme.title = 'Tema chiaro';
        } else {
          i.className = 'ph ph-moon';
          DOM.btnTheme.title = 'Tema scuro';
        }
      },

      render() {
        const raw = DOM.input.value;
        if (!raw) {
          DOM.output.innerHTML = '<i style="color:grey; font-size:14px">In attesa di testo...</i>';
          return;
        }
        const converted = Engine.processMDtoWA(raw);
        DOM.output.innerHTML = Engine.processWAtoHTML(converted);
      },

      async copy() {
        const raw = DOM.input.value;
        if (!raw) return;

        const final = Engine.processMDtoWA(raw);

        try {
          await navigator.clipboard.writeText(final);
          this.showToast({ ok: true, text: 'Convertito e copiato!' });
        } catch (err) {
          // Fallback for older browsers / non-secure contexts
          const ok = this.legacyCopy(final);
          this.showToast({ ok, text: ok ? 'Convertito e copiato!' : 'Copia non riuscita (browser/blocco permessi)' });
        }
      },

      legacyCopy(text) {
        const ta = document.createElement('textarea');
        ta.value = text;
        ta.setAttribute('readonly', '');
        ta.style.position = 'fixed';
        ta.style.left = '-9999px';
        ta.style.top = '0';
        document.body.appendChild(ta);
        ta.select();
        ta.setSelectionRange(0, ta.value.length);
        let ok = false;
        try { ok = document.execCommand('copy'); } catch (_) { ok = false; }
        document.body.removeChild(ta);
        return ok;
      },

      tagWrap(wrapper) {
        const field = DOM.input;
        const start = field.selectionStart;
        const end = field.selectionEnd;
        const text = field.value;

        const before = text.substring(0, start);
        const select = text.substring(start, end);
        const after = text.substring(end);

        // Preserve selection around wrapped text
        const nextValue = before + wrapper + select + wrapper + after;

        field.value = nextValue;
        const newStart = start + wrapper.length;
        const newEnd = end + wrapper.length;
        try { field.setSelectionRange(newStart, newEnd); } catch (_) {}

        History.captureNow({ force: true });
        this.render();
        field.focus();
      },

      tagPrefix(prefix) {
        const field = DOM.input;
        const text = field.value;
        let start = field.selectionStart;
        let end = field.selectionEnd;

        // If user selected multiple lines, prefix each line
        const selStartLine = text.lastIndexOf('\n', start - 1) + 1;
        const selEndLineBreak = text.indexOf('\n', end);
        const selEndLine = selEndLineBreak === -1 ? text.length : selEndLineBreak;

        const block = text.slice(selStartLine, selEndLine);
        const lines = block.split('\n');
        const prefixed = lines.map(l => (l.trim().length ? prefix + l : l)).join('\n');

        const nextValue = text.slice(0, selStartLine) + prefixed + text.slice(selEndLine);
        field.value = nextValue;

        // Update selection: keep roughly same selection block
        const delta = prefixed.length - block.length;
        start = start + prefix.length; // good enough for single-line; multi-line still fine
        end = end + delta;
        try { field.setSelectionRange(start, end); } catch (_) {}

        History.captureNow({ force: true });
        this.render();
        field.focus();
      },

      showToast({ ok, text }) {
        DOM.toastText.textContent = text;
        DOM.toastIcon.className = ok ? 'ph-fill ph-check-circle' : 'ph-fill ph-warning-circle';
        DOM.toastIcon.style.color = ok ? '#4ade80' : '#fbbf24';

        DOM.toast.classList.add('in');
        clearTimeout(this._toastTimer);
        this._toastTimer = setTimeout(() => DOM.toast.classList.remove('in'), 2200);
      },

      clock() {
        const n = new Date();
        DOM.time.innerText = n.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
      }
    };

    App.init();
  </script>
</body>
</html>
